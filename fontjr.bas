5     peekloc=alloc(1):cursor off 10    cls :poke $D001,6:rem "Enable 2x size text"30    bitmap on :bitmap clear 040    text "Font jr. - Foenix Font Editor"dim 1 colour 255 to 0,050    rect solid colour 255 from 8,16 to 88,2360    rect solid colour 255 from 8,24 to 15,9670    rect solid colour 255 from 81,24 to 88,9680    rect solid colour 255 from 8,89 to 88,9690    showglyph()160   setupui()180   clrchar()190   renderchar(0)200   sprcursor(242)210   posx=0:posy=0:edix=0:ediy=0220   char=0:edit=0230   repeat 250   k=inkey()260   if k=13:rem "Toggle edit/char select mode"270   edit=(edit+1)&1280   if edit=1290   clrchar()300   renderchar(char)320   sprite 1 image 1 to 20,28330   else 340   sprite 1 off 350   endif 380   endif 390   if k=16 then y=-1400   if k=14 then y=1410   if k=6 then x=1420   if k=2 then x=-1430   if k=32b1=1 else b1=0 endif 440   if edit=0450   posx=(posx+x)455   if posx<0posx=31 else posx=posx&31 endif 460   posy=(posy+y)465   if posy<0posy=7 else posy=posy&7 endif 470   char=posy*32+posx480   sprite 0 to 5+posx*8,180+posy*8490   x=0:y=0500   else 510   edix=edix+x:ediy=ediy+y520   if edix<0edix=7 else edix=edix&7 endif 530   if ediy<0ediy=7 else ediy=ediy&7 endif 540   sprite 1 to 20+edix*8,28+ediy*8550   x=0:y=0560   endif 570   if b1=1580   if edit=1590   addr=$C000+char*8+ediy:pow(7-edix)600   ?1=1:value=?addr:?1=0610   if (value&power)>0620   renderbit(edix,ediy,0):value=value-power630   else 640   renderbit(edix,ediy,1):value=value+power650   endif 660   ?1=1:?addr=value:?1=0680   endif 690   endif 700   if k=130:rem "save font"710   txtscreen()720   input "Provide Filename to Save (.font will be added):";a$730   a$=a$+".font":savefont(a$)740   cls :poke $D001,6:bitmap on :showglyph()750   endif 760   if k=129:rem "load font"770   txtscreen()780   input "Provide Filename to Load (.font will be added):";a$790   a$=a$+".font":loadfont(a$)800   cls :poke $D001,6:bitmap on :showglyph()810   endif 999   until k=1131000  cls :bitmap clear 0:poke $D001,01010  cursor on :sprites off 1020  print "Thx for using 'Font Jr' the Foenix Font Editor!"1030  a$="menu.bas":print "loading ";a$:bload a$,$28000:xgo 1040  end2000  proc printat(x,y,a$)2010  local pos:pos=x+y*40:?1=22020  for c=0 to len(a$)-1:?(pos+c+$C000)=asc(mid$(a$,c+1,1)):next 2030  ?1=02040  endproc 2050  proc clrchar()2055  rect solid color 0 from 16,24 to 80,882060  for c=0 to 72070  for d=0 to 72080  plot colour 255 to 4+16+d*8,24+4+c*82090  next 2100  next 2110  endproc 2150  proc renderchar(a)2160  addr=$C000+a*82170  for c=0 to 72180  for d=0 to 72190  ?1=1:pow(d):v=peek(addr+c)&power:v1=peek(addr+c):?1=02200  if v>0 then rect colour 255 from 73-d*8,24+1+c*8 to 78-d*8,24+6+c*82210  next 2230  next 2250  endproc 2300  proc pow(a)2310  power=12330  power=power<<a2340  endproc 2350  proc sprcursor(n)2355  sprites on 2360  xpoke($30000,$11):xpoke($30001,$0):xpoke($30002,0)2370  memcopy $30003,64 poke n2380  for c=1 to 100:next 2400  sprite 0 to 5,180 image 02410  memcopy $30043,66 poke 02420  xpoke($30043,0):xpoke($30044,0)2430  memcopy $30045,8 poke n2440  memcopy $30085-8,8 poke n2450  xpoke($30045+8,n):xpoke($30045+15,n)2455  xpoke($30045+16,n):xpoke($30045+23,n)2457  xpoke($30045+24,n):xpoke($30045+31,n)2460  xpoke($30045+32,n):xpoke($30045+39,n)2465  xpoke($30045+40,n):xpoke($30045+47,n)2467  xpoke($30045+48,n):xpoke($30045+55,n)2470  endproc 3000  proc xpoke(addr,value)3010  poke peekloc,value3020  memcopy peekloc,1 to addr3030  endproc 3050  proc renderbit(x,y,bitval)3060  colr=0:x=7-x3070  if bitval<>0 then colr=2553080  rect solid colour colr from 73-x*8,25+y*8 to 78-x*8,30+y*83085  plot colour 255 to 20+(7-x)*8,28+y*83090  endproc 3100  proc setupui()3110  rect solid colour 250 from 0,0 to 319,83120  text "Font jr. - Foenix Font Editor"dim 1 colour 255 to 0,03130  text "F1 - Load Font"dim 1 to 22*8,4*83140  text "F2 - Save Font"dim 1 to 22*8,5*83150  text "Cursor Keys - Move Cursor "dim 1 to 13*8,6*83160  text "Enter/Return - Switch Mode"dim 1 to 12*8,7*83170  text "(Select/Edit)"dim 1 to 26*8,8*83180  text "Spacebar - Toggle Bit"dim 1 to 16*8,9*83190  text "Q - Quit Program"dim 1 to 23*8,10*83200  rect solid colour 250 from 0,20*8 to 319,21*83210  text "Select Glyph to Edit "dim 1 colour 255 to 0,20*83250  endproc 3300  proc showglyph()3310  a$=""3320  for c=0 to 73330  a$=""3340  for d=0 to 313350  if c*32+d>0a$=a$+chr$(c*32+d) else a$="0"endif 3360  next 3370  printat(0,22+c,a$)3380  ?1=2:?($C000+22*40)=0:?1=03390  next 3400  endproc 3450  proc savefont(a$)3460  ?1=1:rem "use I/o page 1 - font"3470  for c=0 to 2047:rem "One font has 2kb of data"3480  ?($7800+c)=?($C000+c):rem "copy font to upper 2k of basic memory"3490  next 3495  ?1=0:rem "restore I/o page"3500  try bsave a$,$7800,2047 to ec3600  if ec<>0 then print "Font failed to save, check and try again"3610  if ec=0 then print "Font file ";a$;" succesfully saved!"3620  print "Press any key to continue"3630  k=inkey():if k=0 then goto 36303640  endproc 3650  proc loadfont(a$)3660  try bload a$,$7800 to ec3670  if ec=03680  ?1=13690  for c=0 to 20473700  ?($C000+c)=?($7800+c)3710  next 3720  print "Font ";a$;" succesfully loaded!"3730  ?1=03740  else 3750  print "File ";a$;" could not be loaded.."3780  endif 3785  print "Press any key to continue"3790  k=inkey():if k=0 then goto 37903800  endproc 4000  proc txtscreen()4010  cls :poke $D001,32:bitmap off 4020  endproc 每每每每